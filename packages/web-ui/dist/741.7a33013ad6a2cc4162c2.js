(()=>{"use strict";const t=self;let e=!1,n=null,o=null,s=null;function r(e){t.postMessage(e)}function i(){n&&(clearTimeout(n),n=null)}t.onmessage=t=>{var c,a;const d=t.data;if(d&&"object"==typeof d)if("run"!==d.type||e){if("stop"===d.type){e=!1,i();try{s&&s()}catch(l){}r({type:"stopped",systemId:d.systemId})}}else{e=!0;const{systemId:t,source:l,config:y,meta:u}=d;try{const i={log:(...e)=>r({type:"log",systemId:t,args:e}),metric:e=>r({type:"metric",systemId:t,pnl:e}),placeOrder:e=>r({type:"order",systemId:t,order:e})},a=new Function("api","config","meta",`\n          "use strict";\n          // User code can define: start(api, config, meta), onTick(ctx), stop()\n          ${l||""};\n          // expose any globals the user defined:\n          return {\n            start: (typeof start === 'function') ? start : undefined,\n            onTick: (typeof onTick === 'function') ? onTick : undefined,\n            stop: (typeof stop === 'function') ? stop : undefined\n          };\n        `)(i,y||{},u||{})||{};o="function"==typeof a.onTick?a.onTick:null;const d="function"==typeof a.start?a.start:null;s="function"==typeof a.stop?a.stop:null;try{d&&d(i,y,u)}catch(p){r({type:"error",systemId:t,error:String((null===(c=p)||void 0===c?void 0:c.message)||p)})}let f=0;const m=()=>{var s;if(e){f++;try{o&&o({t:f,config:y,meta:u})}catch(p){r({type:"error",systemId:t,error:String((null===(s=p)||void 0===s?void 0:s.message)||p)})}n=setTimeout(m,1e3)}};m()}catch(p){r({type:"error",systemId:d.systemId,error:String((null===(a=p)||void 0===a?void 0:a.message)||p)}),e=!1,i()}}}})();
//# sourceMappingURL=741.7a33013ad6a2cc4162c2.js.map